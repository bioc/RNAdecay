<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Reed Sorenson | reed.sorenson@utah.edu | Department of Biology | University of Utah" />

<meta name="date" content="2017-12-21" />

<title>RNAdecay Vignette 3: Decay Plotter</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore"><em>RNAdecay</em> Vignette 3: Decay Plotter</h1>
<h4 class="author"><em>Reed Sorenson | <a href="mailto:reed.sorenson@utah.edu">reed.sorenson@utah.edu</a> | Department of Biology | University of Utah</em></h4>
<h4 class="date"><em>2017-12-21</em></h4>



<div id="load-decay-data-and-modeling-results-and-optionally-gene-descriptions" class="section level2">
<h2>7. LOAD DECAY DATA AND MODELING RESULTS (AND, OPTIONALLY, GENE DESCRIPTIONS)</h2>
<p>[For steps 1-6 see <em>RNAdecay Vignette 1: Decay Factor Normalization of RNA-seq RPM data for Decay Modeling</em> and <em>RNAdecay Vignette 2: Double Exponential RNA Decay Modeling</em> in this package.]</p>
<p>Load normalized read data and reorder factor levels of “treatment” as you would like them to appear in the plot key and in the order you want them to plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RNAdecay)
decaydata =<span class="st"> </span>RNAdecay<span class="op">::</span>decaydata <span class="co"># built-in package example data; comment this line out to use your own decaydata</span>
decaydata<span class="op">$</span>treatment =<span class="st"> </span><span class="kw">factor</span>(decaydata<span class="op">$</span>treatment, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;WT&quot;</span>, <span class="st">&quot;sov&quot;</span>, <span class="st">&quot;vcs&quot;</span>, <span class="st">&quot;vs&quot;</span>)) <span class="co"># you must type them identically in the new order  </span>
<span class="kw">levels</span>(decaydata<span class="op">$</span>treatment)[<span class="dv">4</span>] =<span class="st"> &quot;vcs sov&quot;</span>
decaydata[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,]</code></pre></div>
<pre><code>##      geneID treatment t.decay  rep     value
## 1 AT1G02860        WT       0 rep1 1.0051056
## 2 AT1G09660        WT       0 rep1 1.1187229
## 3 AT1G13360        WT       0 rep1 1.0821496
## 4 AT1G22470        WT       0 rep1 0.9173587</code></pre>
<p>Load modeling results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results=RNAdecay<span class="op">::</span>results <span class="co"># built-in package example data; comment this line out to use your own results</span>
<span class="co"># For example:</span>
<span class="co"># results = read.delim(&quot;~/DecayAnalysis/Example analysis results 2/alphas+betas+mods+grps+patterns+relABs.txt&quot;, header = TRUE, colClasses =  c(NA, rep(&quot;numeric&quot;, 9), rep(&quot;integer&quot;, 3), rep(&quot;character&quot;, 3), rep(&quot;numeric&quot;, 6)))</span>
<span class="co"># results$alpha_subgroup = factor(results$alpha_subgroup, levels = unique(results$alpha_subgroup))</span>
results[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, ]</code></pre></div>
<pre><code>##              alpha_WT   alpha_sov   alpha_vcs alpha_vcs.sov     beta_WT
## AT1G02860 0.006571237 0.006571237 0.006571237   0.002956901 0.004372148
## AT1G09660 0.006349482 0.006349482 0.006349482   0.003583661 0.005964932
## AT1G13360 0.065720699 0.065720699 0.019776977   0.019776977 0.027849987
##              beta_sov    beta_vcs beta_vcs.sov      sigma2 mod alpha_grp
## AT1G02860 0.004372148 0.004372148  0.004372148 0.013891487  79         5
## AT1G09660 0.005964932 0.009436538  0.005964932 0.006533780  68         5
## AT1G13360 0.027849987 0.005538462  0.005538462 0.004749049 188        12
##           beta_grp alpha_subgroup             alphaPattern
## AT1G02860       15            5.1  5_vcs.sov&lt;=WT&lt;=sov&lt;=vcs
## AT1G09660        4            5.1  5_vcs.sov&lt;=WT&lt;=sov&lt;=vcs
## AT1G13360       12           12.1 12_vcs&lt;=vcs.sov&lt;=WT&lt;=sov
##                        betaPattern rA_WT rA_sov    rA_vcs rA_vcssov
## AT1G02860 15_WT&lt;=sov&lt;=vcs&lt;=vcs.sov     1      1 1.0000000 0.4499763
## AT1G09660  4_WT&lt;=sov&lt;=vcs.sov&lt;=vcs     1      1 1.0000000 0.5644021
## AT1G13360 12_vcs&lt;=vcs.sov&lt;=WT&lt;=sov     1      1 0.3009246 0.3009246
##           nEqMods nEqAgp
## AT1G02860       9      3
## AT1G09660      13      4
## AT1G13360       4      2</code></pre>
<p>Optionally, for printing gene descriptions directly on the plot, load a gene description file and then generate a character vector of descriptions with elements named with geneIDs (e.g. for <em>Arabidopsis thaliana</em>, download and unzip <a href="https://www.arabidopsis.org/download_files/Genes/TAIR10_genome_release/gene_description_20131231.txt.gz" class="uri">https://www.arabidopsis.org/download_files/Genes/TAIR10_genome_release/gene_description_20131231.txt.gz</a>, and place it in your working directory).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gene_desc =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;~/gene_description_20140101.txt&quot;</span>, <span class="dt">quote =</span> <span class="ot">NULL</span>, <span class="dt">comment =</span> <span class="st">''</span>, <span class="dt">header =</span> <span class="ot">FALSE</span>)
gene_desc[, <span class="dv">1</span>] =<span class="st"> </span><span class="kw">substr</span>(gene_desc[, <span class="dv">1</span>], <span class="dv">1</span>, <span class="dv">9</span>)
gene_desc =<span class="st"> </span><span class="kw">data.frame</span>(gene_desc[<span class="op">!</span><span class="kw">duplicated</span>(gene_desc[, <span class="dv">1</span>]), ], <span class="dt">row.names =</span> <span class="dv">1</span>)
<span class="kw">colnames</span>(gene_desc) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;type&quot;</span>, <span class="st">&quot;short description&quot;</span>, <span class="st">&quot;long description&quot;</span>, <span class="st">&quot;computational description&quot;</span>)
descriptions =<span class="st"> </span>gene_desc[, <span class="st">&quot;long description&quot;</span>]
<span class="kw">names</span>(descriptions) =<span class="st"> </span><span class="kw">rownames</span>(gene_desc)</code></pre></div>
</div>
<div id="print-decay-plots-to-pdf" class="section level2">
<h2>8. PRINT DECAY PLOTS TO PDF</h2>
<p>Plot a single gene using <code>DecayPlot</code>. If you do not have a gene desription file, do not include “Desc” in the <code>what</code> argument (see <code>?DecayPlot</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p =<span class="st"> </span><span class="kw">DecayPlot</span>(<span class="dt">geneID =</span> <span class="st">&quot;AT1G02860&quot;</span>, 
              <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">350</span>), 
              <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.25</span>), 
              <span class="dt">xticks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span><span class="op">*</span><span class="dv">100</span>, 
              <span class="dt">yticks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">5</span><span class="op">/</span><span class="dv">4</span>,
              <span class="dt">alphaSZ  =</span>  <span class="dv">12</span>, 
              <span class="dt">what  =</span>  <span class="kw">c</span>(<span class="st">&quot;meanSE&quot;</span>, <span class="st">&quot;reps&quot;</span>, <span class="st">&quot;models&quot;</span>),
              <span class="dt">treatments  =</span>  <span class="kw">c</span>(<span class="st">&quot;WT&quot;</span>, <span class="st">&quot;vcs sov&quot;</span>), 
              <span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;red3&quot;</span>),
              <span class="dt">DATA =</span> decaydata, 
              <span class="dt">mod.results =</span> results, 
              <span class="dt">gdesc =</span> descriptions)
<span class="kw">print</span>(p<span class="op">+</span><span class="kw">myTheme</span>(<span class="dv">8</span>, <span class="dv">1</span>, <span class="dt">leg.pos =</span> <span class="kw">c</span>(<span class="fl">0.7</span>, <span class="fl">0.8</span>))) <span class="co">#this will print the plot to your current graphics device (dev.cur() tells you what that is), if you do not have a graphics device open (e.g., &quot;null device&quot;) initiate one (e.g., use quartz(),pdf(), or windows(); dev.off() closes the device and writes the file).</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Plot one or multiple genes write them to a pdf file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># make new directory for results</span>
wrdir =<span class="st"> &quot;~/DecayAnalysis/Example analysis results 3&quot;</span>
<span class="cf">if</span>(<span class="op">!</span><span class="kw">file.exists</span>(wrdir)) <span class="kw">dir.create</span>(wrdir, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)

<span class="kw">pdf</span>(<span class="kw">paste0</span>(wrdir, <span class="st">&quot;/decay plot example.pdf&quot;</span>), <span class="dt">width =</span> <span class="dv">10</span>, <span class="dt">height =</span> <span class="dv">8</span>)
p =<span class="st"> </span><span class="kw">DecayPlot</span>(<span class="dt">geneID =</span> <span class="st">&quot;AT1G02860&quot;</span>, 
              <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">500</span>), 
              <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.25</span>), 
              <span class="dt">xticks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span><span class="op">*</span><span class="dv">100</span>, 
              <span class="dt">yticks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">5</span><span class="op">/</span><span class="dv">4</span>,
              <span class="dt">alphaSZ =</span> <span class="dv">10</span>, 
              <span class="dt">what =</span> <span class="kw">c</span>(<span class="st">&quot;Desc&quot;</span>,<span class="st">&quot;meanSE&quot;</span>, <span class="st">&quot;reps&quot;</span>, <span class="st">&quot;models&quot;</span>,<span class="st">&quot;alphas&amp;betas&quot;</span>),
              <span class="dt">treatments =</span> <span class="kw">c</span>(<span class="st">&quot;WT&quot;</span>, <span class="st">&quot;vcs sov&quot;</span>),
              <span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;red3&quot;</span>),
              <span class="dt">DATA =</span> decaydata,
              <span class="dt">mod.results =</span> results,
              <span class="dt">gdesc =</span> descriptions)
<span class="kw">print</span>(p<span class="op">+</span><span class="kw">myTheme</span>(<span class="dv">32</span>, <span class="dv">1</span>, <span class="dt">leg.pos =</span> <span class="st">'right'</span>))
<span class="kw">dev.off</span>()</code></pre></div>
<pre><code>## png 
##   2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot multiple genes</span>
ids =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;AT5G54730&quot;</span>, <span class="st">&quot;AT1G27730&quot;</span>, <span class="st">&quot;AT4G34190&quot;</span>)
<span class="co"># or e.g.,</span>
<span class="co"># ids = rownames(results[results$alpha_WT &gt; 0.1, ]) </span>

<span class="kw">pdf</span>(<span class="kw">paste0</span>(wrdir, <span class="st">&quot;/multiple gene decay plots.pdf&quot;</span>), <span class="dt">width =</span> <span class="dv">10</span>, <span class="dt">height =</span> <span class="dv">7</span>)
<span class="cf">for</span>(i <span class="cf">in</span> ids){
  p =<span class="st"> </span><span class="kw">DecayPlot</span>(i, 
                <span class="dt">what =</span> <span class="kw">c</span>(<span class="st">&quot;meanSE&quot;</span>, <span class="st">&quot;models&quot;</span>, <span class="st">&quot;Desc&quot;</span>),
                <span class="dt">mod.results =</span> results, 
                <span class="dt">gdesc =</span> descriptions, 
                <span class="dt">DATA =</span> decaydata)
  <span class="kw">print</span>(p<span class="op">+</span><span class="kw">myTheme</span>(<span class="fl">13.8</span>, <span class="dv">1</span>, <span class="dt">leg.pos =</span> <span class="st">'right'</span>))
  <span class="kw">cat</span>(i, <span class="st">&quot; plotted.</span><span class="ch">\n</span><span class="st">&quot;</span>)
}</code></pre></div>
<pre><code>## AT5G54730  plotted.</code></pre>
<pre><code>## AT1G27730  plotted.</code></pre>
<pre><code>## AT4G34190  plotted.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dev.off</span>()</code></pre></div>
<pre><code>## png 
##   2</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
