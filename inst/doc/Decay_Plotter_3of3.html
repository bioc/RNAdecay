<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Reed Sorenson | reed.sorenson@utah.edu | Department of Biology | University of Utah" />

<meta name="date" content="2018-01-31" />

<title>RNAdecay Vignette 3: Decay Plotter</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore"><em>RNAdecay</em> Vignette 3: Decay Plotter</h1>
<h4 class="author"><em>Reed Sorenson | <a href="mailto:reed.sorenson@utah.edu">reed.sorenson@utah.edu</a> | Department of Biology | University of Utah</em></h4>
<h4 class="date"><em>2018-01-31</em></h4>



<div id="load-decay-data-and-modeling-results-and-optionally-gene-descriptions" class="section level2">
<h2>7. LOAD DECAY DATA AND MODELING RESULTS (AND, OPTIONALLY, GENE DESCRIPTIONS)</h2>
<p>[For steps 1-6 see <em>RNAdecay Vignette 1: Decay Factor Normalization of RNA-seq RPM data for Decay Modeling</em> and <em>RNAdecay Vignette 2: RNA Decay Modeling</em> in this package.]</p>
<p>Load normalized read data and reorder factor levels of “treatment” as you would like them to appear in the plot key and in the order you want them to plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RNAdecay)
decaydata =<span class="st"> </span>RNAdecay<span class="op">::</span>decaydata <span class="co"># built-in package example data; comment this line out to use your own decaydata</span>
decaydata<span class="op">$</span>treatment =<span class="st"> </span><span class="kw">factor</span>(decaydata<span class="op">$</span>treatment, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;WT&quot;</span>, <span class="st">&quot;sov&quot;</span>, <span class="st">&quot;vcs&quot;</span>, <span class="st">&quot;vs&quot;</span>)) <span class="co"># you must type them identically in the new order  </span>
<span class="kw">levels</span>(decaydata<span class="op">$</span>treatment)[<span class="dv">4</span>] =<span class="st"> &quot;vcs sov&quot;</span>
decaydata[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,]</code></pre></div>
<pre><code>##      geneID treatment t.decay  rep     value
## 1 AT1G02860        WT       0 rep1 1.0051056
## 2 AT1G09660        WT       0 rep1 1.1187229
## 3 AT1G13360        WT       0 rep1 1.0821496
## 4 AT1G22470        WT       0 rep1 0.9173587</code></pre>
<p>Load modeling results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results=RNAdecay<span class="op">::</span>results <span class="co"># built-in package example data; comment this line out to use your own results</span>
<span class="co"># For example:</span>
<span class="co"># results = read.delim(&quot;~/DecayAnalysis/Example analysis results 2/alphas+betas+mods+grps+patterns+relABs.txt&quot;, header = TRUE, colClasses =  c(NA, rep(&quot;numeric&quot;, 9), rep(&quot;integer&quot;, 3), rep(&quot;character&quot;, 3), rep(&quot;numeric&quot;, 6)))</span>
<span class="co"># results$alpha_subgroup = factor(results$alpha_subgroup, levels = unique(results$alpha_subgroup))</span>
results[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, ]</code></pre></div>
<pre><code>##              alpha_WT   alpha_sov   alpha_vcs alpha_vcs.sov     beta_WT
## AT1G02860 0.006571237 0.006571237 0.006571237   0.002956901 0.004372148
## AT1G09660 0.006349482 0.006349482 0.006349482   0.003583661 0.005964932
## AT1G13360 0.065720699 0.065720699 0.019776977   0.019776977 0.027849987
##              beta_sov    beta_vcs beta_vcs.sov      sigma2 mod alpha_grp
## AT1G02860 0.004372148 0.004372148  0.004372148 0.013891487  79         5
## AT1G09660 0.005964932 0.009436538  0.005964932 0.006533780  68         5
## AT1G13360 0.027849987 0.005538462  0.005538462 0.004749049 188        12
##           beta_grp alpha_subgroup             alphaPattern
## AT1G02860       15            5.1  5_vcs.sov&lt;=WT&lt;=sov&lt;=vcs
## AT1G09660        4            5.1  5_vcs.sov&lt;=WT&lt;=sov&lt;=vcs
## AT1G13360       12           12.1 12_vcs&lt;=vcs.sov&lt;=WT&lt;=sov
##                        betaPattern rA_WT rA_sov    rA_vcs rA_vcssov
## AT1G02860 15_WT&lt;=sov&lt;=vcs&lt;=vcs.sov     1      1 1.0000000 0.4499763
## AT1G09660  4_WT&lt;=sov&lt;=vcs.sov&lt;=vcs     1      1 1.0000000 0.5644021
## AT1G13360 12_vcs&lt;=vcs.sov&lt;=WT&lt;=sov     1      1 0.3009246 0.3009246
##           nEqMods nEqAgp
## AT1G02860       9      3
## AT1G09660      13      4
## AT1G13360       4      2</code></pre>
<p>Optionally, for printing gene descriptions directly on the plot, load a gene description file and then generate a character vector of descriptions with elements named with geneIDs (e.g. for <em>Arabidopsis thaliana</em>, download and unzip <a href="https://www.arabidopsis.org/download_files/Genes/TAIR10_genome_release/gene_description_20131231.txt.gz" class="uri">https://www.arabidopsis.org/download_files/Genes/TAIR10_genome_release/gene_description_20131231.txt.gz</a>, and place it in your working directory).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># gene_desc = read.delim(&quot;~/gene_description_20140101.txt&quot;, quote = NULL, comment = '', header = FALSE)</span>
<span class="co"># gene_desc[, 1] = substr(gene_desc[, 1], 1, 9)</span>
<span class="co"># gene_desc = data.frame(gene_desc[!duplicated(gene_desc[, 1]), ], row.names = 1)</span>
<span class="co"># colnames(gene_desc) = c(&quot;type&quot;, &quot;short description&quot;, &quot;long description&quot;, &quot;computational description&quot;)</span>
<span class="co"># descriptions = gene_desc[, &quot;long description&quot;]</span>
<span class="co"># names(descriptions) = rownames(gene_desc)</span>

descriptions=<span class="kw">c</span>(<span class="st">&quot;Encodes a ubiquitin E3 ligase with RING and SPX domains that is involved in mediating immune responses and mediates degradation of PHT1s at plasma membranes.  Targeted by MIR827. Ubiquitinates PHT1;3, PHT1;2, PHT1;1/AtPT1 and PHT1;4/AtPT2.&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;Related to Cys2/His2-type zinc-finger proteins found in higher plants. Compensated for a subset of calcineurin deficiency in yeast. Salt tolerance produced by ZAT10 appeared to be partially dependent on ENA1/PMR2, a P-type ATPase required for Li+ and Na+ efflux in yeast. The protein is localized to the nucleus, acts as a transcriptional repressor and is responsive to chitin oligomers. Also involved in response to photooxidative stress.&quot;</span>,<span class="st">&quot;Encodes a stress enhanced protein that localizes to the thylakoid membrane and whose mRNA is upregulated in response to high light intensity.  It may be involved in chlorophyll binding.&quot;</span>)
<span class="kw">names</span>(descriptions) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;AT1G02860&quot;</span>,<span class="st">&quot;AT5G54730&quot;</span>, <span class="st">&quot;AT1G27730&quot;</span>, <span class="st">&quot;AT4G34190&quot;</span>)</code></pre></div>
</div>
<div id="print-decay-plots-to-pdf" class="section level2">
<h2>8. PRINT DECAY PLOTS TO PDF</h2>
<p>Plot a single gene using <code>DecayPlot</code>. If you do not have a gene desription file, do not include “Desc” in the <code>what</code> argument (see <code>?DecayPlot</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p =<span class="st"> </span><span class="kw">DecayPlot</span>(<span class="dt">geneID =</span> <span class="st">&quot;AT1G02860&quot;</span>, 
              <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">350</span>), 
              <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.25</span>), 
              <span class="dt">xticks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span><span class="op">*</span><span class="dv">100</span>, 
              <span class="dt">yticks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">5</span><span class="op">/</span><span class="dv">4</span>,
              <span class="dt">alphaSZ  =</span>  <span class="dv">12</span>, 
              <span class="dt">what  =</span>  <span class="kw">c</span>(<span class="st">&quot;meanSE&quot;</span>, <span class="st">&quot;reps&quot;</span>, <span class="st">&quot;models&quot;</span>),
              <span class="dt">treatments  =</span>  <span class="kw">c</span>(<span class="st">&quot;WT&quot;</span>, <span class="st">&quot;vcs sov&quot;</span>), 
              <span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;red3&quot;</span>),
              <span class="dt">DATA =</span> decaydata, 
              <span class="dt">mod.results =</span> results, 
              <span class="dt">gdesc =</span> descriptions)
<span class="kw">print</span>(p<span class="op">+</span><span class="kw">myTheme</span>(<span class="dv">8</span>, <span class="dv">1</span>, <span class="dt">leg.pos =</span> <span class="kw">c</span>(<span class="fl">0.7</span>, <span class="fl">0.8</span>))) <span class="co">#this will print the plot to your current graphics device (dev.cur() tells you what that is), if you do not have a graphics device open (e.g., &quot;null device&quot;) initiate one (e.g., use quartz(),pdf(), or windows(); dev.off() closes the device and writes the file).</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Plot one or multiple genes write them to a pdf file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># make new directory for results</span>
wrdir =<span class="st"> &quot;~/DecayAnalysis/Example analysis results 3&quot;</span>
<span class="cf">if</span>(<span class="op">!</span><span class="kw">file.exists</span>(wrdir)) <span class="kw">dir.create</span>(wrdir, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)

<span class="kw">pdf</span>(<span class="kw">paste0</span>(wrdir, <span class="st">&quot;/decay plot example.pdf&quot;</span>), <span class="dt">width =</span> <span class="dv">10</span>, <span class="dt">height =</span> <span class="dv">8</span>)
p =<span class="st"> </span><span class="kw">DecayPlot</span>(<span class="dt">geneID =</span> <span class="st">&quot;AT1G02860&quot;</span>, 
              <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">500</span>), 
              <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.25</span>), 
              <span class="dt">xticks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span><span class="op">*</span><span class="dv">100</span>, 
              <span class="dt">yticks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">5</span><span class="op">/</span><span class="dv">4</span>,
              <span class="dt">alphaSZ =</span> <span class="dv">10</span>, 
              <span class="dt">what =</span> <span class="kw">c</span>(<span class="st">&quot;Desc&quot;</span>,<span class="st">&quot;meanSE&quot;</span>, <span class="st">&quot;reps&quot;</span>, <span class="st">&quot;models&quot;</span>,<span class="st">&quot;alphas&amp;betas&quot;</span>),
              <span class="dt">treatments =</span> <span class="kw">c</span>(<span class="st">&quot;WT&quot;</span>, <span class="st">&quot;vcs sov&quot;</span>),
              <span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;red3&quot;</span>),
              <span class="dt">DATA =</span> decaydata,
              <span class="dt">mod.results =</span> results,
              <span class="dt">gdesc =</span> descriptions)
<span class="kw">print</span>(p<span class="op">+</span><span class="kw">myTheme</span>(<span class="dv">32</span>, <span class="dv">1</span>, <span class="dt">leg.pos =</span> <span class="st">'right'</span>))
<span class="kw">dev.off</span>()</code></pre></div>
<pre><code>## png 
##   2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot multiple genes</span>
ids =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;AT5G54730&quot;</span>, <span class="st">&quot;AT1G27730&quot;</span>, <span class="st">&quot;AT4G34190&quot;</span>)
<span class="co"># or e.g.,</span>
<span class="co"># ids = rownames(results[results$alpha_WT &gt; 0.1, ]) </span>

<span class="kw">pdf</span>(<span class="kw">paste0</span>(wrdir, <span class="st">&quot;/multiple gene decay plots.pdf&quot;</span>), <span class="dt">width =</span> <span class="dv">10</span>, <span class="dt">height =</span> <span class="dv">7</span>)
<span class="cf">for</span>(i <span class="cf">in</span> ids){
  p =<span class="st"> </span><span class="kw">DecayPlot</span>(i, 
                <span class="dt">what =</span> <span class="kw">c</span>(<span class="st">&quot;meanSE&quot;</span>, <span class="st">&quot;models&quot;</span>, <span class="st">&quot;Desc&quot;</span>),
                <span class="dt">mod.results =</span> results, 
                <span class="dt">gdesc =</span> descriptions, 
                <span class="dt">DATA =</span> decaydata)
  <span class="kw">print</span>(p<span class="op">+</span><span class="kw">myTheme</span>(<span class="fl">13.8</span>, <span class="dv">1</span>, <span class="dt">leg.pos =</span> <span class="st">'right'</span>))
  <span class="kw">cat</span>(i, <span class="st">&quot; plotted.</span><span class="ch">\n</span><span class="st">&quot;</span>)
}</code></pre></div>
<pre><code>## AT5G54730  plotted.</code></pre>
<pre><code>## AT1G27730  plotted.</code></pre>
<pre><code>## AT4G34190  plotted.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dev.off</span>()</code></pre></div>
<pre><code>## png 
##   2</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
